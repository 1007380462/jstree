<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>jsTree API documentation</title>

	<link rel="stylesheet" href="./bootstrap.min.css" />
	<link rel="stylesheet" href="./default.css" />
	<!--[if lt IE 7]><meta http-equiv="imagetoolbar" content="false" /><![endif]-->
	<style>
	html, body { background:#ebebeb; }
	html { overflow-y:scroll; }
	.container { width:100%; background:white; margin:20px auto; border-radius:5px; box-shadow:0 0 4px silver; max-width:1200px; min-width:320px; }
	.item { margin:20px; }
	h2 { font-family:Georgia, serif; }
	h3 { margin:0px 20px -10px 20px; font-family:Georgia, serif; padding-top:20px; border-top:1px dotted silver; }
	.docs { padding-top:10px; width:50%; }
	.code { float:right; width:45%; }
	.code pre { overflow:auto; }
	code.selected { background:#DD1144; border-color:#DD1144; color:white; }
	pre code { background:transparent; }
	</style>
</head>
<body>
	<div class="container" role="main">

	</div>

	<script src="./jquery.1.9.1.min.js"></script>
	<script src="./highlight.pack.js"></script>
	<script>
	$.expr[':'].icontains = $.expr.createPseudo(function(search) {
		return function(a) {
			return (a.textContent || a.innerText || "").toLowerCase().indexOf(search.toLowerCase())>=0;
		};
	});
	$(function () {
		var container = $('.container');
		$.getJSON('./jstree.json', function (data) {
			var first = true;
			$.each(data, function (i, v) {
				if(first) {
					container.append('<div style="text-align:center;" class="item clearfix">' + v.description.full + '</div>');
					first = false;
					return true;
				}
				if(!v.ignore) {
					if(!v.code) {
						v.code = '';
					}
					if(v.code.indexOf('\n') > 0) {
						var l = v.code.split('\n')[1].split('\t').length - 1;
						v.code = new Array(l).join('\t') + v.code;
						v.code = v.code.replace(new RegExp('^\t{'+(l-1)+'}','mg'), '');
					}
					v.code = v.code.replace(/\t/g,'  ')
					container.append('<div class="item clearfix"><div class="code"><pre><code>' + v.code + '</code></pre></div><div class="docs">' + v.description.full + '</div><div>');
				}
				//container.append(v.description.full);
			});
			$('.docs > h3').each(function () {
				$(this).closest('.item').before($(this));
			});
			$('.item:eq(0)').append('<div class="input-append" style="transition: box-shadow 0.2s linear 0s; width:260px; text-align:center; border-radius:0 0 10px 10px; margin:0 auto; margin-left:-140px; left:50%; top:220px; position:absolute; padding:10px; background:white;"><input class="search" id="q" value="" placeholder="Begin typing to search" type="text" /><button class="btn" type="button" id="cls" onclick="$(this).prev().val(\'\').keypress();" title="Clear search">&times;</button></div>').css('paddingBottom', '60px');
			var q = $('#q').parent(),
				t = q.offset().top,
				d = $(document);
			q.data('fixed', false);
			d.bind('scroll', function () {
				if(d.scrollTop() > t) {
					if(q.data('fixed') === false) {
						q.css({'position':'fixed', 'top':'0', 'boxShadow':'0 0 5px gray'}).data('fixed', true);
					}
				}
				else {
					if(q.data('fixed') === true) {
						q.css({'position':'absolute', 'top':'220px', 'boxShadow':'none'}).data('fixed', false);
					}
				}
			});
			var to = false;
			if(document.location.hash && document.location.hash.length) {
				$('#q').val(document.location.hash.replace(/^#/,''));
			}
			$('#q').on('keydown', function (e) {
				//e.preventDefault();
				if(to) { clearTimeout(to); }
				to = setTimeout(function () {
					var s = $.trim($('#q').val().replace(/[^a-z0-9_.]+/i,''));
					$('.alert').remove();
					$('.selected').removeClass('selected');
					if(s.length) {
						var i = $('.docs code:icontains("' + s + '")').addClass('selected').closest('.item'),
							t = $();
						
						i.each(function () {
							t = t.add($(this));
							t = t.add($(this).prevAll('h3:eq(0)'));
						});
						t.show();
						$('.item:gt(0), h3').not(t).hide();

						//$('body').animate({ 'scrollTop' : t.eq(0).offset().top }, 200);

						if(t.length == 0) {
							$('.container').append('<div class="alert alert-error" style="margin:20px; text-align:center; padding:20px;">No methods or properties matching `' + s + '`</div>');
						}
						$('#cls').prop('disabled', false);
					}
					else {
						$('.item, h3').show();
						$('#cls').prop('disabled', true);
					}
					document.location.hash = s;
				}, 200);
			}).select().keydown();
			$('pre').each(function () { hljs.highlightBlock(this); });
		});
	});
	</script>
</body>
</html>